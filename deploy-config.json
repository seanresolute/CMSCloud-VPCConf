{
  "ConfigAccountID": "546085968493",
  "ConfigRegion": "us-east-1",
  "Apps": {
    "vpc-conf": {
      "ArtifactDBProjectName": "vpc-conf",
      "ContainerDefinitionTemplates": [
        {
          "Image": "{{.Account}}.dkr.ecr.{{.Region}}.amazonaws.com/{{.Artifact.Value}}",
          "LogConfiguration": {
            "LogDriver": "awslogs",
            "Options": {
              "awslogs-group": "/aws/ecs/vpc-conf-{{.Environment}}",
              "awslogs-region": "{{.Region}}",
              "awslogs-stream-prefix": "ecs"
            }
          },
          "PortMappings": [
            {
              "hostPort": 2020,
              "protocol": "tcp",
              "containerPort": 2020
            }
          ],
          "environment": [
            {
              "name": "GOTRACEBACK",
              "value": "all"
            }
          ],
          "secrets": [
            {
              "valueFrom": "vpc-conf-{{.Environment}}-cloudtamer-host",
              "name": "CLOUDTAMER_BASE_URL"
            },
            {
              "valueFrom": "vpc-conf-{{.Environment}}-cloudtamer-idms-id",
              "name": "CLOUDTAMER_IDMS_ID"
            },
            {
              "valueFrom": "vpc-conf-{{.Environment}}-cloudtamer-admin-group-id",
              "name": "CLOUDTAMER_ADMIN_GROUP_ID"
            },
            {
              "valueFrom": "vpc-conf-{{.Environment}}-ipam-host",
              "name": "IPCONTROL_HOST"
            },
            {
              "valueFrom": "vpc-conf-{{.Environment}}-ipam-password",
              "name": "IPCONTROL_PASSWORD"
            },
            {
              "valueFrom": "vpc-conf-{{.Environment}}-ipam-username",
              "name": "IPCONTROL_USERNAME"
            },
            {
              "valueFrom": "vpc-conf-{{.Environment}}-rds-conn-str",
              "name": "POSTGRES_CONNECTION_STRING"
            },
            {
              "valueFrom": "vpc-conf-{{.Environment}}-groot-config",
              "name": "CMSNET_CONFIG"
            },
            {
              "valueFrom": "vpc-conf-{{.Environment}}-jira-username",
              "name": "JIRA_USERNAME"
            },
            {
              "valueFrom": "vpc-conf-{{.Environment}}-jira-config",
              "name": "JIRA_CONFIG"
            },
            {
              "valueFrom": "vpc-conf-{{.Environment}}-jira-issue-labels",
              "name": "JIRA_ISSUE_LABELS"
            },
            {
              "valueFrom": "vpc-conf-{{.Environment}}-jira-oauth-config",
              "name": "JIRA_OAUTH_CONFIG"
            },
            {
              "valueFrom": "vpc-conf-{{.Environment}}-cloudtamer-read-only-group-ids",
              "name": "CLOUDTAMER_READ_ONLY_GROUP_IDS"
            },
            {
              "valueFrom": "vpc-conf-{{.Environment}}-cloudtamer-service-account-username",
              "name": "CLOUDTAMER_SERVICE_ACCOUNT_USERNAME"
            },
            {
              "valueFrom": "vpc-conf-{{.Environment}}-cloudtamer-service-account-password",
              "name": "CLOUDTAMER_SERVICE_ACCOUNT_PASSWORD"
            },
            {
              "valueFrom": "vpc-conf-{{.Environment}}-cloudtamer-service-account-idms-id",
              "name": "CLOUDTAMER_SERVICE_ACCOUNT_IDMS_ID"
            },
            {
              "valueFrom": "vpc-conf-{{.Environment}}-only-aws-account-ids",
              "name": "ONLY_AWS_ACCOUNT_IDS"
            },
            {
              "valueFrom": "vpc-conf-{{.Environment}}-azure-ad-client-id",
              "name": "AZURE_AD_CLIENT_ID"
            },
            {
              "valueFrom": "vpc-conf-{{.Environment}}-azure-ad-host",
              "name": "AZURE_AD_HOST"
            },
            {
              "valueFrom": "vpc-conf-{{.Environment}}-azure-ad-redirect-url",
              "name": "AZURE_AD_REDIRECT_URL"
            },
            {
              "valueFrom": "vpc-conf-{{.Environment}}-azure-ad-tenant-id",
              "name": "AZURE_AD_TENANT_ID"
            },
            {
              "valueFrom": "vpc-conf-{{.Environment}}-creds-svc-config",
              "name": "CREDS_SVC_CONFIG"
            },
            {
              "valueFrom": "vpc-conf-{{.Environment}}-api-key-config",
              "name": "API_KEY_CONFIG"
            },
            {
              "valueFrom": "vpc-conf-{{.Environment}}-orchestration-api-key",
              "name": "ORCHESTRATION_API_KEY"
            },
            {
              "valueFrom": "vpc-conf-{{.Environment}}-orchestration-base-url",
              "name": "ORCHESTRATION_BASE_URL"
            }
          ],
          "MemoryReservation": 300,
          "StopTimeout": 120,
          "Name": "vpc-conf-{{.Environment}}"
        }
      ],
      "PreDeployCommandTemplates": [
        {
          "Program": "vpc-conf-task-queue",
          "Arguments": [
            "-env",
            "{{.Environment}}",
            "stop"
          ]
        }
      ],
      "PostDeployCommandTemplates": [
        {
          "Program": "vpc-conf-task-queue",
          "Arguments": [
            "-env",
            "{{.Environment}}",
            "-allow-only",
            "{{.TaskDefinition}}",
            "start"
          ]
        }
      ],
      "Environments": {
        "dev": {
          "AccountID": "346570397073",
          "Region": "us-east-1",
          "CPU": "512",
          "Memory": "1024",
          "ExecutionRoleARN": "arn:aws:iam::346570397073:role/vpc-conf-dev",
          "TaskRoleARN": "arn:aws:iam::346570397073:role/vpc-conf-dev",
          "Family": "vpc-conf-dev",
          "Cluster": "vpc-conf-dev",
          "SecurityGroups": [
            "sg-0611c19d83e109c99"
          ],
          "Subnets": [
            "subnet-020e69ca13a260ebf",
            "subnet-0970fe25c0b2b62e9",
            "subnet-0e84ad7f96523c669"
          ],
          "ListenerARN": "arn:aws:elasticloadbalancing:us-east-1:346570397073:listener/app/vpc-conf-dev/7fd7e626b0dab0a9/44bdd60e187ccf6a",
          "TargetGroupARNs": {
            "blue": "arn:aws:elasticloadbalancing:us-east-1:346570397073:targetgroup/vpc-conf-dev-blue/c21cde5e9e3074e8",
            "green": "arn:aws:elasticloadbalancing:us-east-1:346570397073:targetgroup/vpc-conf-dev-green/5efc3e0c22dfe0a8"
          }
        },
        "prod": {
          "RequiresPreviousEnvDeploy": "dev",
          "AccountID": "546085968493",
          "Region": "us-east-1",
          "CPU": "512",
          "Memory": "1024",
          "ExecutionRoleARN": "arn:aws:iam::546085968493:role/vpc-conf-prod",
          "TaskRoleARN": "arn:aws:iam::546085968493:role/vpc-conf-prod",
          "Family": "vpc-conf-prod",
          "Cluster": "vpc-conf-prod",
          "SecurityGroups": [
            "sg-0813624e5ed82e831"
          ],
          "Subnets": [
            "subnet-0748880e05e95863b",
            "subnet-0711d67cabcba685f",
            "subnet-0e716c85b161a0b4b"
          ],
          "ListenerARN": "arn:aws:elasticloadbalancing:us-east-1:546085968493:listener/app/vpc-conf-prod/4bab8b3ced5d7260/089868cbf592e4c2",
          "TargetGroupARNs": {
            "blue": "arn:aws:elasticloadbalancing:us-east-1:546085968493:targetgroup/vpc-conf-prod-blue/f72b49939d219bf2",
            "green": "arn:aws:elasticloadbalancing:us-east-1:546085968493:targetgroup/vpc-conf-prod-green/7c486616222aed37"
          }
        }
      }
    },
    "creds-api": {
      "ArtifactDBProjectName": "creds-api",
      "ContainerDefinitionTemplates": [
        {
          "Image": "{{.Account}}.dkr.ecr.{{.Region}}.amazonaws.com/{{.Artifact.Value}}",
          "LogConfiguration": {
            "LogDriver": "awslogs",
            "Options": {
              "awslogs-group": "/aws/ecs/creds-api-{{.Environment}}",
              "awslogs-region": "{{.Region}}",
              "awslogs-stream-prefix": "ecs"
            }
          },
          "PortMappings": [
            {
              "hostPort": 2023,
              "protocol": "tcp",
              "containerPort": 2023
            }
          ],
          "secrets": [
            {
              "valueFrom": "creds-api-{{.Environment}}-api-key-config",
              "name": "API_KEY_CONFIG"
            },
            {
              "valueFrom": "creds-api-{{.Environment}}-is-govcloud",
              "name": "IS_GOVCLOUD"
            }
          ],
          "MemoryReservation": 300,
          "StopTimeout": 120,
          "Name": "creds-api-{{.Environment}}"
        }
      ],
      "Environments": {
        "dev": {
          "AccountID": "346570397073",
          "Region": "us-west-2",
          "CPU": "512",
          "Memory": "1024",
          "ExecutionRoleARN": "arn:aws:iam::346570397073:role/creds-api-dev",
          "TaskRoleARN": "arn:aws:iam::346570397073:role/creds-api-dev",
          "Family": "creds-api-dev",
          "Cluster": "creds-api-dev",
          "SecurityGroups": [
            "sg-056b385e9c2c4d1c4"
          ],
          "Subnets": [
            "subnet-0e850dda260b98871",
            "subnet-0ed6508c39acfa5b5",
            "subnet-07f7984785c36aa1e"
          ],
          "ListenerARN": "arn:aws:elasticloadbalancing:us-west-2:346570397073:listener/app/creds-api-dev/097f199d4557c488/e150ff8f7e69da84",
          "TargetGroupARNs": {
            "blue": "arn:aws:elasticloadbalancing:us-west-2:346570397073:targetgroup/creds-api-dev-blue/c6c331ad1e46538b",
            "green": "arn:aws:elasticloadbalancing:us-west-2:346570397073:targetgroup/creds-api-dev-green/6fd43075d3b3e8f0"
          }
        },
        "prod": {
          "AccountID": "546085968493",
          "Region": "us-east-1",
          "CPU": "512",
          "Memory": "1024",
          "ExecutionRoleARN": "arn:aws:iam::546085968493:role/creds-api-prod",
          "TaskRoleARN": "arn:aws:iam::546085968493:role/creds-api-prod",
          "Family": "creds-api-prod",
          "Cluster": "creds-api-prod",
          "SecurityGroups": [
            "sg-029b59ef1f63b776b"
          ],
          "Subnets": [
            "subnet-0e716c85b161a0b4b",
            "subnet-0711d67cabcba685f",
            "subnet-0748880e05e95863b"
          ],
          "ListenerARN": "arn:aws:elasticloadbalancing:us-east-1:546085968493:listener/app/creds-api-prod/b279cde9ffc511ba/95240a41e0c86207",
          "TargetGroupARNs": {
            "blue": "arn:aws:elasticloadbalancing:us-east-1:546085968493:targetgroup/creds-api-prod-blue/d667496f136af0c1",
            "green": "arn:aws:elasticloadbalancing:us-east-1:546085968493:targetgroup/creds-api-prod-green/88a6754c72223f26"
          }
        }
      }
    }
  }
}
